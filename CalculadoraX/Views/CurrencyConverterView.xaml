<UserControl x:Class="CalculadoraX.Views.CurrencyConverterView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:behaviors="clr-namespace:CalculadoraX.Behaviors">
    <UserControl.InputBindings>
        <KeyBinding Key="Enter" Command="{Binding ConvertCommand}" />
    </UserControl.InputBindings>
    <Grid Margin="12">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="1.2*" />
            <ColumnDefinition Width="0.8*" />
        </Grid.ColumnDefinitions>

        <StackPanel Margin="0 0 24 0">
            <TextBlock Text="Conversión de monedas" FontSize="26" FontWeight="SemiBold" />
            <TextBlock Text="Trabajamos con CLP, UF, USD y EUR usando valores actualizados." Margin="0 4 0 16" />

            <TextBlock Text="Tengo" FontWeight="SemiBold" />
            <DockPanel Margin="0 4 0 16" LastChildFill="False">
                <TextBox Width="200"
                         Text="{Binding InputAmount, UpdateSourceTrigger=PropertyChanged}"
                         behaviors:InputBehaviors.FocusOnVisible="True"
                         behaviors:InputBehaviors.SelectAllOnFocus="True"
                         behaviors:InputBehaviors.NumericOnly="True" />
                <ComboBox Margin="12 0 0 0"
                          Width="Auto"
                          MinWidth="100"
                          ItemsSource="{Binding AvailableCurrencies}"
                          SelectedItem="{Binding SourceCurrency}"
                          HorizontalAlignment="Left" />
            </DockPanel>

            <TextBlock Text="Convertir a" FontWeight="SemiBold" />
            <ComboBox Width="Auto"
                      MinWidth="100"
                      ItemsSource="{Binding AvailableCurrencies}"
                      SelectedItem="{Binding TargetCurrency}" />

            <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                <Button Content="Convertir"
                        Command="{Binding ConvertCommand}"
                        Style="{StaticResource PrimaryButtonStyle}" />
                <Button Content="Actualizar valores"
                        Command="{Binding RefreshCommand}"
                        Style="{StaticResource SecondaryButtonStyle}" />
            </StackPanel>

            <Border Background="#10FF0000"
                    Padding="12"
                    Margin="0 16 0 0"
                    CornerRadius="8"
                    Visibility="{Binding ErrorMessage, Converter={StaticResource StringToVisibilityConverter}}">
                <TextBlock Text="{Binding ErrorMessage}" Foreground="#FFB71C1C" />
            </Border>

            <Border Style="{StaticResource CardStyle}" Margin="0 16 0 0">
                <StackPanel>
                    <DockPanel>
                        <TextBlock Text="Equivale hoy a" FontSize="20" FontWeight="SemiBold" DockPanel.Dock="Left" />
                        <Button Content="Copiar"
                                Command="{Binding CopyResultCommand}"
                                Style="{StaticResource SecondaryButtonStyle}"
                                Padding="6 2"
                                FontSize="14"
                                Margin="8 0 0 0"
                                MinWidth="0"
                                DockPanel.Dock="Right" />
                    </DockPanel>
                    <TextBlock Text="{Binding ResultText}" FontSize="36" FontWeight="Bold" />
                    <TextBlock Text="{Binding LastUpdated, StringFormat='Datos al {0}'}" Margin="0 8 0 0" />
                    <TextBlock Text="{Binding CopyFeedback}"
                               Foreground="{StaticResource PrimaryBrush}"
                               FontSize="14"
                               Margin="0 6 0 0"
                               Visibility="{Binding CopyFeedback, Converter={StaticResource StringToVisibilityConverter}}" />
                </StackPanel>
            </Border>
        </StackPanel>

        <StackPanel Grid.Column="1">
            <DockPanel>
                <TextBlock Text="Referencias del día" FontSize="20" FontWeight="SemiBold" DockPanel.Dock="Left" />
            </DockPanel>
            <ItemsControl ItemsSource="{Binding ReferenceRates}">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <UniformGrid Columns="2" />
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Border Style="{StaticResource CardStyle}">
                            <StackPanel>
                                <TextBlock Text="{Binding Code}" FontSize="18" FontWeight="SemiBold" />
                                <TextBlock Text="{Binding DisplayValue}" FontSize="28" FontWeight="Bold" />
                                <TextBlock Text="Valor en CLP" FontSize="14" Foreground="#88000000" />
                            </StackPanel>
                        </Border>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </StackPanel>
    </Grid>
</UserControl>
